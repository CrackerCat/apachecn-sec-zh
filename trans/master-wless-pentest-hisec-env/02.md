# 二、无线安全测试

欢迎来到这一章！我们假设您非常喜欢第一章，以至于决定继续，或者您跳过了它，因为您对已经知道的内容感到满意。不管是哪种情况，这都是你的第一个问题。普通用户会购买无线路由器，而不会配置任何无线安全。你认为这是为什么？

当然，你一直都知道，这是因为普通用户可能不知道设备上的安全功能或注意事项，或者他们可能懂计算机，但不知道如何实现无线安全。这就是**Wi-Fi 保护设置**（**WPS**的作用。

WPS 允许在无线家庭网络上轻松配置。用户只需按下无线路由器上的按钮，无线路由器就会自动为用户配置安全网络。听起来不错，对吧？错误的最常见的无线路由器成为暴力攻击的受害者。WPS PIN 通常只包含数字。此安全漏洞允许攻击者使用暴力技术在几小时内恢复或破解 WPS PIN。

不仅仅是用户，甚至连公司和 ISP 都在这样做。他们只需插入无线路由器，按下 WPS 按钮，然后为您写下密钥。这是非常糟糕的安全性，尤其是在商业网络上！请花时间更改用户名、更改默认密码、关闭远程管理和打开防火墙。

本章将介绍以下主题：

*   无线渗透测试方法
*   无线攻击技术与方法
*   预防

# 无线渗透测试方法

无线渗透测试建立在成熟的行业标准之上。共有六个步骤：

*   侦察
*   攻击和渗透
*   客户端攻击
*   入网
*   漏洞评估
*   利用和数据捕获

在我们回顾方法中的每个步骤之前，您将了解为什么遵循这些步骤很重要。

## 我为什么要遵循这种方法？

这六个步骤为渗透测试专家所熟知和大力推荐。这些步骤为 PTES、NIST 800-115 和 OSSTMM 等测试方法所熟知。您可以在虚拟化环境中执行这些操作，以帮助在对生产性网络采取操作之前测试漏洞利用率。它还通过渗透测试帮助确定问题的根本原因。

无线接入点为无需电线的通信提供了简便性。这也为黑客提供了攻击和访问您的内部网络的便利。从内部看，它们可能造成严重损害，并损害敏感的公司和客户信息。无论他们是把车停在外面、大楼前面，还是在设施周围开车，黑客都能找到进入你的网络的方法。遵循无线渗透测试方法将有助于识别漏洞，并提供加固和修复解决方案。

## 无线攻击和渗透步骤

以下是无线渗透测试期间要采取的步骤：

侦察：

*   扫描无线接入点

    *   查找目标接入点

*   识别 SSID 和 MAC 地址

    *   广播名称
    *   AP 的 Wi-Fi MAC 地址

*   收集加密和密码信息

    *   WEP、WPA、WPA2
    *   PSK、AES、TPK

*   嗅探无线网络

    *   通过 Wi-Fi 收集网络流量

*   剩余不可检测

    *   欺骗 IP 或旋转连接
    *   保持低调不引起任何注意

攻击和渗透：

*   绕过或攻击安全控制

    *   抓取横幅
    *   密码猜测和破解
    *   SQL 注入
    *   通过 HTTP、HTTPS、SSH 和 Telnet 协议

    获取访问权限
*   使用 macchanger 等工具欺骗 Mac 地址
*   破解无线加密算法

    *   机组 ng、收割机

客户端攻击：

*   本地和远程攻击

    *   常用密码
    *   通过 Linux 访问文件而无需登录
    *   操纵操作系统创建后门

*   捕获并破解凭证

    *   Wireshark
    *   Ettercap NG

扫描网络：

*   识别主机

    *   Nmap 扫描仪

*   确定网络大小

    *   Zenmap 扫描仪

漏洞评估：

*   运行自动或手动漏洞扫描

    *   Nessus 漏洞扫描程序

*   生成漏洞报告

    *   通过 Nessus 漏洞扫描器

    导出报告

利用和数据捕获：

*   渗透

    *   利用无线路由器和接入点获取对网络资源的未经授权访问

*   妥协

    *   获得工作站和服务器的完全管理权限

*   数据分析
*   报告

总之，无线渗透测试方法简单地帮助您了解从侦察到报告的步骤。它还为您提供了如何成为无线渗透测试仪的想法。无线渗透测试应该每年进行一次，以跟上无线网络不断变化的威胁。在为客户端执行无线安全审核时，应参考此方法。

# 无线攻击技术与方法

以下各节介绍了不同类型的无线攻击技术和方法。

## 访问控制攻击

访问控制攻击试图使用无线或规避 WLAN 访问控制措施（如 AP MAC 过滤器和 802.11 端口访问控制）渗透网络：

![Access control attacks](graphics/3183OS_02_01.jpg)

以下部分显示了一些访问控制攻击。

### 战争驾驶

战争驱动意味着通过监听信标或通过提供进一步攻击的发射点发送探测请求来发现无线局域网。Airmon ng、DStumbler、KisMAC 和 NetStumbler 等工具可以执行此攻击。战争驾驶通常由两人完成，一人驾驶汽车，另一人扫描并发现该地区的无线网络。有了正确的软件和应用程序，他们可以设置 GPS 设置来精确定位这些 Wi-Fi 位置，并将其保存起来，以备以后的无线攻击。

![War driving](graphics/3183OS_02_02.jpg)

照片来源：Elhombredeegro 通过 photopin cc

### 流氓接入点

在商业网络上留下一个不安全的 AP 可以创建一个进入可信网络的开放后门，用户可以远程进入服务器或访问网络设备，如防火墙、交换机和路由器。任何无线路由器或软件 AP 都可以执行此攻击，如下图所示。请避免连接到不安全的无线接入点。连接到开放式或公共的 Wi-Fi 网络时，始终使用 VPN 服务保护自己。

![Rogue access points](graphics/3183OS_02_03.jpg)

### 临时协会

特设协会正在将直接连接到一个不安全的无线 AP，以规避 AP 安全或攻击另一个无线 AP。这是一种非常常见的攻击，如下图所示。我见过无线网络，其中 SSID 被改为类似“黑客”的东西。攻击者通过无线连接并更改无线接入点上的安全设置，或更改密码以锁定所有者。

![Ad hoc associations](graphics/3183OS_02_04.jpg)

### MAC 欺骗

MAC 欺骗是一个术语，攻击者将其自己的 MAC 地址重新配置为授权 AP 或客户端。这使攻击者能够通过无线接入点完全访问网络，就像他们是受信任的 AP 或客户端一样。此攻击通常用于付费热点位置，如酒店、机场、咖啡馆和其他付费互联网位置。MAC 欺骗攻击如下图所示：

![MAC spoofing](graphics/3183OS_02_05.jpg)

### 802.11 半径裂纹

我们很少听到关于这次袭击的报道，但这是一个重要的话题。此攻击是攻击者通过暴力强制 802.11 访问请求恢复**远程身份验证拨入用户服务**（**RADIUS**）机密以进行恶意使用。AP 和 RADIUS 服务器之间的 LAN 网络上的任何数据包捕获工具都可以工作。这是非常危险的，因为许多 AP、服务器甚至软件服务都会要求 RADIUS 登录。如果 RADIUS 遭到破坏，攻击者可以访问任何使用 RADIUS 授权访问的内容。此攻击如下图所示：

![802.11 RADIUS cracking](graphics/3183OS_02_06.jpg)

## 机密攻击

这些攻击试图截获通过无线网络发送的私人信息，无论是以明文形式发送还是通过 802.11 或更高层协议加密。

![Confidential attacks](graphics/3183OS_02_07.jpg)

照片来源：IvoyelephantPhotography 通过 photopin cc

以下各节介绍了一些机密攻击。

### 窃听

我们当然知道窃听是什么，但你知道它在安全世界中意味着什么吗？与计算机安全相关的窃听是指捕获数据，对其进行解码，然后获取潜在的敏感信息。这就像偷听电话一样。你倾听、记录，然后可能从对话中获得敏感信息。诸如 Ettercap、Kismet 和 Wireshark 等工具都可以做到这一点。此攻击如下图所示：

![Eavesdropping](graphics/3183OS_02_08.jpg)

### WEP 键开裂

啊，现在是谈论 WEP 破解的时候了！这与使用被动或主动方法捕获数据以恢复 WEP 密钥听起来完全一样。随着今天硬件和软件的改进，WEP 加密可以在不到 5 分钟内轻松破解！WEP 加密只能在旧硬件仍在使用的情况下使用；否则，您应该使用 WPA2 加密。Aircrack ng、AirSnort、Airoway、chopchop 和 dwepcrack 等工具可以执行这些攻击。以下屏幕截图显示了 WEP 密钥破解的示例：

![WEP key cracking](graphics/3183OS_02_09.jpg)

### 邪恶孪生兄弟 AP

听说过一个邪恶的双胞胎 AP 吗？一个邪恶的孪生 AP 就像一个流氓接入点。攻击者创建了一个假的无线 AP，诱使用户认为它是一个可信的无线网络。由于信标的速度更快，距离更近，因此它们以客户端自动连接的方式放大信号。诸如蜜罐、CqureAP、D-Link G200、HermesAP、Rogue 中队和 WifiBSD 等工具可以执行这些攻击。下图显示了一个常用工具：

![Evil twin AP](graphics/3183OS_02_10.jpg)

### AP 网络钓鱼

攻击者在假冒的 AP 上运行假冒的 web 门户网站或 web 服务器，以获取登录名、银行账户和信用卡号。这是迄今为止遇到的最危险、最恐怖的攻击之一，因为普通用户甚至看不到攻击发生在他们身上。他们会相信这是真实的网站，而事实上，攻击者只是在等待他们登录以获取另一端的信息。诸如 Airpwn、Airsnarf、hostpotter、Karma 和 RGlueAP 等工具可以执行这些攻击。

![AP Phishing](graphics/3183OS_02_11.jpg)

图片来源：infocux Technologies 通过 photopin cc

### 中间的那个人发起了攻击

我当然希望你以前听说过这种攻击方法；如果不是，你现在就可以！中间人攻击是指攻击者拦截您与另一目标之间的网络流量。攻击者可以在有线或无线网络上使用此攻击获取用户名、密码、查看电子邮件、查看网站的 HTTP 会话等。dsniff、Ettercap NG 和 sshmitm 等工具可以执行这些攻击。此攻击如下图所示：

![The man-in-the-middle attack](graphics/3183OS_02_12.jpg)

## 凭证攻击

有没有听说过或遇到过一个在线账户被泄露的用户？该用户很可能是凭据攻击的受害者，该攻击与攻击者窃取其登录凭据有关。这可以通过网络服务器或软件完成，如**社会工程工具包**（**集**。攻击者可以克隆网站，使网站看起来真实合法，足以诱骗用户登录。他们几乎不知道现在有人可以完全访问他们的数据。在以下各节中，我们将讨论凭据收割机和网络钓鱼攻击方法。

### 凭证收割机

此攻击启动攻击者系统上的 Apache 服务器克隆一个网站，使其看起来像合法网站。攻击者可以将无线接入点和 DNS 欺骗 HTTP 请求加入到假冒网站。该网站将与用户尝试正常登录的真实网站完全相同。在攻击者端，攻击者将能够看到用户的用户名和密码以及该用户的 IP 地址。从这里，攻击者可以继续收集帐户登录名，然后将其存储在生成的报告中。必须对组织的员工执行社会工程攻击，以测试他们是否遵守程序和安全策略。这显示在以下屏幕截图中：

![Credential harvester](graphics/3183OS_02_13.jpg)

### 网络钓鱼

那么什么是网络钓鱼以及我们如何识别网络钓鱼攻击、欺诈或恶作剧？网络钓鱼是一种欺诈行为，试图收集敏感信息，如用户名、密码、社会安全号码、电话号码和信用卡。这些攻击通常通过直接发送给用户的电子邮件进行识别，用户被告知访问网站，了解其信息更新、密码更改或验证信息。保护自己免受网络钓鱼计划攻击的最好方法是了解它们是如何工作的。向未知发件人询问密码或更改密码的电子邮件很可能是伪造的电子邮件。这些电子邮件将需要被阻止或标记为钓鱼或垃圾邮件。如果您认为自己是网络钓鱼的受害者，请立即更改密码和安全问题，以防止在线帐户中的任何损坏或信息丢失。

## 身份验证攻击

攻击者使用身份验证攻击窃取合法用户身份和凭据，以访问专用网络和服务。

![Authentication attacks](graphics/3183OS_02_14.jpg)

照片来源：FutUndBeidl 通过 photopin cc

以下部分解释了一些身份验证攻击。

### 共享密钥猜测

攻击者试图通过使用供应商默认凭据或共享密钥生成器猜测 802.11 共享密钥身份验证。所有共享密钥不应保留为默认值，应在设置和配置设备后立即更改。任何破解工具（如 Aircrack ng）都可以执行此攻击。

![Shared key guessing](graphics/3183OS_02_15.jpg)

照片来源：marc falardeau 通过 photopin cc

### PSK 开裂

PSK 破解攻击使用字典攻击工具从捕获的密钥握手帧中恢复 WPA/WPA2 PSK。这种攻击实际上取决于 WPA/WPA2 密钥的加密强度。如果这把钥匙真的很牢固，它可能需要数周的时间才能破解，这可能不值得黑客花时间破解。创建自己的密码时，始终混合使用字母、数字和符号。你的角色数越长，你就越不可能成为目标。coWPAtty、genpmk、KisMAC 和 wpa_crack 等工具可以执行这些攻击。以下屏幕截图显示了 PSK 破解攻击：

![PSK cracking](graphics/3183OS_02_16.jpg)

### 嗅探应用程序凭据

当嗅探应用程序凭据时，攻击者从明文应用程序协议中捕获用户凭据，如电子邮件地址和密码。现在越来越多的网站使用 HTTPS，这在流行网站上不太可能发生；然而，当登录到无线路由器或接入点时，通常使用 HTTP，这是未加密的明文。如果您通过 HTTP 协议登录，攻击者很容易看到您的用户名和密码。Ace 密码嗅探器、dsniff、PHOS 和 Win 嗅探器等工具可以执行这些攻击。

![Sniffing application credentials](graphics/3183OS_02_17.jpg)

照片来源：都柏林（维克多）通过 photopin cc 拍摄

### 破解域名账号

当破解域帐户攻击时，攻击者通过使用蛮力或字典攻击工具破解 NetBIOS 密码哈希来恢复用户的凭据，如其 Windows 登录名和密码。还有一些工具需要使用 Internet Explorer、Firefox 和 Google Chrome 浏览器保存的密码。一旦攻击者获得您的凭据，他们就可以访问网络共享、交换电子邮件，如果该帐户恰好具有管理权限，甚至可能危及整个域。开膛手约翰、10phtcrack 和凯恩等工具可以执行这些攻击。

![Cracking domain accounts](graphics/3183OS_02_18.jpg)

照片来源：ntr23 通过 photopin cc

### VPN 登录破解

攻击者通过对 VPN 身份验证协议运行暴力攻击来恢复用户凭据，如 PPTP 或 IPsec 密码。确保密码和预共享密钥彼此不同并且非常强大。容易猜出的密码或数字很容易危及整个业务，从而导致客户信息泄露。诸如-scan、IKECrack、anger 和 THC-pptp-bruter 等工具可以执行这些攻击。下图说明了 VPN 登录破解攻击：

![VPN login cracking](graphics/3183OS_02_19.jpg)

### 802.11 识别盗窃

在 802.11 身份盗窃攻击中，攻击者通过无线 802.11 从明文中捕获用户配置文件。加密是确保数据不被泄露的关键。在连接到 Wi-Fi 网络时，使用 HTTPS 和 VPN 协议可以帮助您免受此类攻击。诸如 Wireshark 或 eTerCap NG 之类的捕获工具可以做到这一点。

![802.11 identify theft](graphics/3183OS_02_20.jpg)

照片来源：B Rosen 通过 photopin cc

### 802.11 密码猜测

在 802.11 密码猜测攻击中，攻击者使用捕获的身份持续尝试在 802.11 身份验证上猜测用户的密码。攻击者极有可能不断猜测默认密码、供应商名称、最常用密码、生日、姓名、电话号码等，直到他们完全访问该无线网络。如果攻击者拥有非常好的密码字典，他们可以轻松地运行字典攻击，并在数小时内获得访问权限。开膛手约翰和 THC Hydra 等工具可以执行这些攻击。

![802.11 password guessing](graphics/3183OS_02_21.jpg)

照片来源：Dev.Arka 通过 photopin cc

### 802.11 跳跃破解

在 802.11 LEAP 破解攻击中，攻击者使用字典攻击工具破解 NT 密码哈希，从捕获的 802.11 LEAP 数据包中恢复用户凭据。这取决于密码强度，如果密码强度非常好，则不太可能被破解，这就是为什么混合使用字母、数字和符号来防止这些字典攻击极其重要的原因。Anwrap、Asleap 和 THC LEAPcracker 等工具可以执行这些攻击。以下屏幕截图显示了一个示例：

![802.11 LEAP cracking](graphics/3183OS_02_22.jpg)

### 802.11 EAP 降级攻击

802.11 要求 EAP 在连接和认证的用户之间发送消息。如果攻击者可以将自己定位在客户端和身份验证之间，则连接的用户将连接到网络。攻击者通过使用伪造的 EAP 响应/NAK 数据包，强制无线 802.11 设备或服务器提供较弱类型的身份验证。由于身份验证非常弱，攻击者只需几分钟即可快速获得访问权限。File2air 和 libradiate 等工具可以执行这些攻击。以下屏幕截图显示了一个示例：

![802.11 EAP downgrade attack](graphics/3183OS_02_23.jpg)

### 无线网络问题

随着当今科技的飞速发展，我们所知道的互联网每天都会面临许多新的威胁。犯罪分子使用新的恶意软件和社会工程攻击来攻击弱势用户和组织。最终用户通过 Wi-Fi 连接，并使用 web 浏览器浏览互联网。在接下来的章节中，我们将讨论网络罪犯在当今网络上使用的最常见的攻击方法。

![Issues with wireless networks](graphics/3183OS_02_24.jpg)

照片来源：woodleywonderworks 通过 photopin cc

以下部分描述了针对用户级别的最常见攻击之一。

#### 下载

下载是使用互联网的最大特点之一。用户可以快速下载音乐、视频、电子书等。如果用户从未知来源下载，不仅会对其计算机，而且会对整个网络造成严重威胁。下载是危险的，因为大多数下载不需要用户的许可。

这就是恶意软件的由来。如果用户打开他们的电子邮件并单击超链接，它通常会将他们重定向到 web 浏览器以查看该超链接；但是，如果超链接重定向到恶意软件，它将立即下载并在计算机上执行。下载时最好做的事情是考虑你的来源。这是一个合法的网站吗？你能相信吗？如果不是，你就不应该访问该网站，更不用说从中下载文件了。

![Downloading](graphics/3183OS_02_25.jpg)

# 预防

保护自己免受多种威胁的最佳方式是强大的端点保护，如频繁更新和升级、系统配置、定期监控漏洞以及连接到强大的 VPN 服务。如果您在组织中对 IT 负有全部责任，您的员工应该接受良好的教育，了解网络犯罪背后的危险，并知道在使用计算机和电话系统时应采取的良好安全措施。

![Prevention](graphics/3183OS_02_26.jpg)

照片来源：woodleywonderworks 通过 photopin cc

一些员工可能违反公司政策，访问他们的社交网络或在线玩游戏。这些员工需要随时受到监控。只要点击一下，你就很容易陷入灾难性的境地。随着犯罪分子不断更新其恶意软件并发现零日漏洞，最好至少每月运行一次网络审计，并通过电子邮件或 RSS 源随时通知。

连接到公共无线热点时，请始终使用 VPN 服务进行连接。我怎么强调都不过分，这是多么重要。如果您不使用 VPN，则整个网络中的所有 Internet 流量都是未加密的。如果攻击者恰好与您位于同一网络上，则您的登录凭据、信用卡和银行信息都可能掌握在黑客手中。那个黑客很可能会为了自己的利益而使用它，或者在黑市上出售它。

我的策略是总是问自己一个问题，然后再问一些问题。例如，有人告诉你，他们在互联网上免费获得了软件，但没有付费，并想与你分享。他们向你解释说，你必须关闭你的防病毒软件，因为有一个漏洞需要在上面运行。你会安装这个软件吗？我绝对不希望。信任是一个巨大的问题，可能是 IT 世界和现实生活中最难做到的事情之一。

# 总结

在本章中，我们介绍了进行无线渗透测试时要采取的步骤以及无线渗透测试中涉及的常见攻击技术。无线技术正在世界各地得到应用，并扩展了通信能力。

无线渗透方法包括：侦察、攻击和渗透、客户端攻击、进入网络、漏洞评估以及成功运行无线渗透测试的利用和数据捕获。安全中使用的关键元素是防火墙。正确的配置是以安全级别向用户提供服务的关键。

如果您的网络设备配置不当，使用它可能比不使用它要好。当你真的一点都不安全的时候，却认为自己是安全的，这是一种危险的情况。随着网络变得越来越复杂，您需要确保使用 VPN 和隧道协议来确保安全的远程访问。

我们还讨论了几种可以在无线网络上使用的不同攻击方法。无线攻击技术包括但不限于访问控制攻击、机密攻击、凭证攻击、身份验证攻击和无线网络问题。我们充分意识到用户可能面临哪些潜在威胁。这里的关键点是了解当连接到无线接入点和互联网时，我们面临哪些威胁。