# 第 6 章脆弱性评估

在上一章中，我们讨论了如何访问网络和识别网络上的主机。在本章中，我们将讨论一个非常重要的主题，即脆弱性评估，这将引出一个问题，什么是脆弱性评估？

**漏洞评估**，也称为**漏洞分析**，是安全专业人员发现、识别和分类计算机系统、网络或其他形式的电子基础设施中潜在的安全漏洞（漏洞）的地方。此外，脆弱性评估可以提供评估威胁的有效对策。大多数安全专业人员通常遵循一步一步的程序来进行漏洞评估。通用脆弱性评估包括以下内容：

*   发现和分类计算机系统和网络
*   列出最重要的服务
*   识别每个服务的潜在安全威胁
*   规划战略以抵御潜在威胁
*   找到在发生攻击时最小化或降低风险的方法

如果个人或组织发现任何漏洞，他们应对该漏洞负责，并应向供应商报告。如果在未通知供应商的情况下将漏洞检测为高级威胁，则称为**零日**。在开发人员未解决或修补漏洞的情况下，零日攻击很常见。当设备或软件不再受供应商支持时，这是众所周知的。

如果威胁很低，供应商很可能在下次更新之前不会提供修复。这完全取决于威胁是什么以及它能做什么。如果漏洞允许在未经授权的情况下使用远程可执行文件或更糟糕的根或管理员权限，则应立即对其进行修补，但情况并非总是如此。这取决于供应商如何处理这种情况。本组织可能负担不起。

漏洞评估主要由白帽子或认证的道德黑客执行，但有时黑帽子会出于相反的原因使用它。他们可以进行脆弱性评估，以进一步确定他们可以通过某人的网络得到什么。使用这些方法访问漏洞，安全专家可以发现弱点，并提供指导和对策，以防止攻击。

在本章中，我们将介绍以下主题：

*   规划评估
*   设置漏洞扫描程序
*   运行漏洞扫描程序
*   生成报告
*   解决漏洞

# 规划评估

在我们进行评估之前，我们需要开始计划评估。我们首先问自己几个与评估相关的问题。开始吧！

*   How we will be spending our time and resources?

    答：如果您要为个人或企业进行评估，您需要获得成功运行评估所需的估计时间。事先知道你将使用什么进行评估也是很好的。

*   Do you have enough support evidence on your discoveries?

    答：确保您有足够的信息来涵盖您在脆弱性评估期间的发现，这是一种良好的做法。当您开始编写报告时，了解每个漏洞是什么以及它是如何工作的是至关重要的。提供概念证明也很好。

*   When a vulnerability is detected and identified, what is the best way to address the problem?

    答：这个问题实际上取决于威胁的程度。最常见的事情是确保您有最新的更新，升级您的软件，关闭任何未使用的后台服务，提供任何额外的安全级别，如复杂的密码和双向身份验证。向供应商报告该漏洞。

*   How can we improve detection rate and minimize security threats?

    答：商业硬件防火墙可以利用 IDS 和 IPS 监控主动扫描器，在现场检测威胁。WatchGuard 在其硬件防火墙和统一威胁管理系统中提供出色的安全模块，如包过滤、入侵预防服务、应用程序控制、web 阻止程序、网关防病毒程序、垃圾邮件阻止程序等。始终确保更新软件和硬件以降低风险。

要进行成功的评估，需要进行客观、合理的规划。

## 脆弱性评估计划的组成部分

我们将讨论漏洞评估计划的几个关键组件。以下是一个例子：

*   主要目标：

    *   该目标如何处理？
    *   如何实现这一目标？
    *   谁参与了评估？
    *   供应商方提供哪些补丁？
    *   识别常见漏洞
    *   总结

*   第一个目标：

    *   识别问题

*   第二个目标：

    *   提供临时或永久解决方案

*   第三、第四等：

    *   视情况而定，可能需要额外的目标

## 规划脆弱性评估过程

在本节中，我们将介绍一个如何规划脆弱性评估的示例：

*   目标：

    *   是否有开放的网络可用？如果是，它们的用途是什么？

*   标准：

    *   该目标的优先级是什么？

*   策略：

    *   如果网络上有未经授权的用户，他们是否会对工作站或服务器造成任何损坏？
    *   它们是否位于单独的 VLAN 或子网上？

*   方法：

    *   我们能做些什么来达到目标？

*   时间：

    *   有截止日期吗？
    *   我们什么时候可以提供解决方案？

*   结果：

    *   谁需要知道结果？
    *   我们如何防止未来未经授权的用户访问？

这将使您对规划自己的脆弱性评估有一个很好的了解。当您为个人或企业提供服务时，请使用本指南。接下来，我们将设置漏洞扫描程序。我们将介绍的漏洞扫描程序是**Nessus**。

在开始设置漏洞扫描器之前，我们想先了解一下什么是漏洞扫描器，以及为什么理解它非常重要。漏洞扫描程序正是它听起来的样子。它是一种程序或软件安全相关工具，可以扫描计算机、设备和网络的弱点。在大多数情况下，它会自动告诉您可用的低、中或高安全威胁。从安全专业人士的角度来看，这对于进一步分析可能威胁个人或企业的因素非常有帮助。

如果黑帽黑客使用此工具，他们可以利用给定的漏洞快速获得对机密信息或业务数据的未经授权的访问。我们针对公司网络上的漏洞扫描程序进行保护的唯一方法是创建分隔每个部门的 VLAN，强制执行强大的组策略以防止不受信任的可执行文件和安装，限制闪存驱动器的使用，并提供任何形式的保护以防运行未经授权的程序。员工应只运行有助于完成其工作的程序；打开 URL 拦截器并添加安全工具，网站可以快速锁定这些用户。

了解什么是漏洞扫描程序很重要。这是因为，如果硬件防火墙实际上打开了一个本来不应该打开的特定服务或端口，那么这个工具可以非常有助于确定什么可能是您的系统甚至整个网络的后门。防火墙和路由器的默认设置很好，因为它们工作正常？错误的禁用任何未使用的服务并阻止所有未使用的端口（如 FTP、RDP、SSH 和 Telnet）非常重要。

我们将在 Kali Linux 中使用 Nessus 漏洞扫描程序。Nessus 是 Tenable Network Security 开发的专有综合漏洞扫描器。他们提供个人和商业许可软件。我们将使用个人版本进行演示。

Nessus 是世界上最流行的漏洞扫描工具之一。目前全世界有 80000 多个组织正在使用它。Nessus 旨在自动发现已知的安全漏洞。Nessus 最棒的地方之一是它作为客户机和服务器运行。它可以放在网络上，可以在任何地方进行扫描。它运行在 Microsoft Windows、Mac OS X、Linux、FreeBSD、Solaris 和 IBM/AIX 上。报告功能对于渗透测试人员来说非常出色。

Nessus 将检测以下情况：

*   提供远程访问的漏洞
*   访问系统上的敏感数据
*   配置错误的系统（缺少安全补丁、开放端口等）
*   常用密码、默认密码和空白密码
*   使用损坏的数据包进行拒绝服务攻击
*   PCI DSS 审计

它不仅可以检测漏洞，还可以为您提供有关漏洞的信息以及威胁的严重程度。它将提供指向其他信息的链接，如果有可用的安全补丁，它将提供下载这些安全补丁的链接，以帮助提供额外的安全层。

# 设置漏洞扫描程序

在本节中，我们将关注 Nessus。我们将下载并安装 Nessus，注册激活码，激活 Nessus，然后运行第一次扫描。

## 下载 Nessus

Kali Linux 没有预装 Nessus，因此我们需要在开始扫描漏洞之前下载并安装 Nessus。导航至以下网站下载 Nessus 的最新版本：

[http://www.tenable.com/products/nessus/select-your-operating-system](http://www.tenable.com/products/nessus/select-your-operating-system)

根据您的操作系统选择下载：

![Downloading Nessus](graphics/3183OS_06_01.jpg)

## 安装 Nessus

在本演示中，我们将安装 Nessus 漏洞扫描程序。执行以下步骤：

1.  打开一个终端。
2.  Enter the following command and press *Enter*:

    ```
    sudo dpkg –i Nessus-5.2.7-debian6_i386.deb (For 32 bit OS)
    sudo dpkg –i Nessus-5.2.7-debian6_amd64.deb (For 64 bit OS)

    ```

    以下是输出：

    ![Installing Nessus](graphics/3183OS_06_02.jpg)

3.  Enter the following command and press *Enter*:

    ```
    sudo /etc/init.d/nessusd start

    ```

    此命令将启动 Nessus 漏洞扫描工具：

    ![Installing Nessus](graphics/3183OS_06_03.jpg)

4.  打开网页浏览器并导航至`https://127.0.0.1:8834`。
5.  When prompted for the site's security certificate, click on **Proceed anyway**. The following screen appears:

    ![Installing Nessus](graphics/3183OS_06_04.jpg)

6.  You will be presented with the welcome screen for Nessus. Click on the **Get started** button:

    ![Installing Nessus](graphics/3183OS_06_05.jpg)

7.  Create a login and password and click on **Next**:

    ![Installing Nessus](graphics/3183OS_06_06.jpg)

8.  Next, you will need to obtain an activation code:

    ![Installing Nessus](graphics/3183OS_06_07.jpg)

9.  打开您的网络浏览器并导航至[http://www.tenable.com/products/nessus-home](http://www.tenable.com/products/nessus-home) 。
10.  You will need to fill in your information on the right-hand side of the web page:

    ![Installing Nessus](graphics/3183OS_06_08.jpg)

11.  Go back to the activation code field and paste the code you have received via e-mail:

    ![Installing Nessus](graphics/3183OS_06_09.jpg)

12.  After you have entered your activation code, you should receive a message as shown:

    ![Installing Nessus](graphics/3183OS_06_10.jpg)

13.  Nessus will download the plugins. This will take some time so, go do something else and come back when you see this:

    ![Installing Nessus](graphics/3183OS_06_11.jpg)

14.  Once the plugins have finished downloading, you should be prompted to enter your login and password for Nessus home:

    ![Installing Nessus](graphics/3183OS_06_12.jpg)

就这样！您已成功安装并注册 Nessus 漏洞扫描程序。

# 运行漏洞扫描程序

在开始扫描之前，我们需要为扫描创建策略。执行以下步骤以执行此操作：

1.  Log in with your new username that you created earlier:

    ![Running the vulnerability scanner](graphics/3183OS_06_13.jpg)

2.  Click on **Policies** from Nessus and the following screen appears:

    ![Running the vulnerability scanner](graphics/3183OS_06_14.jpg)

3.  Click on the **+** symbol to add a new policy:

    ![Running the vulnerability scanner](graphics/3183OS_06_15.jpg)

4.  Click on the **Save** button to save your settings:

    ![Running the vulnerability scanner](graphics/3183OS_06_16.jpg)

    您应该会收到一条成功消息。

5.  Click on **Scans**:

    ![Running the vulnerability scanner](graphics/3183OS_06_17.jpg)

6.  Next, click on the **+** symbol:

    ![Running the vulnerability scanner](graphics/3183OS_06_18.jpg)

7.  The fields will need to be filled in as follows:

    *   **名称**：`Internal Scan`
    *   **说明**：`Internal Scan`
    *   **目标**：`192.168.1.0/24`

    这是显示在下面的屏幕截图中：

    ![Running the vulnerability scanner](graphics/3183OS_06_19.jpg)

8.  Click on the **Launch** button to start the scan.

    ![Running the vulnerability scanner](graphics/3183OS_06_20.jpg)

    应显示**运行**状态。此过程可能需要一段时间，因为它必须扫描整个内部网络。

9.  Click on the name **Internal Scan**. It should provide scan results, a bar graph, and more, as shown in the following screenshot:

    ![Running the vulnerability scanner](graphics/3183OS_06_21.jpg)

10.  Click on **Vulnerabilities** tab. It should provide a list of vulnerabilities listing **HIGH** on top:

    ![Running the vulnerability scanner](graphics/3183OS_06_22.jpg)

11.  Click on one of the vulnerabilities. It will provide additional information:

    ![Running the vulnerability scanner](graphics/3183OS_06_23.jpg)

12.  Scroll down to view a solution. In this case, it would be wise to upgrade to the latest version of OpenSSL:

    ![Running the vulnerability scanner](graphics/3183OS_06_24.jpg)

该报告提供了有关该漏洞及其作用的信息。它将提供一个解决方案，并提供附加信息的参考链接。对于普通用户来说，这将为您提供问题来源、风险和威胁以及如何解决问题的所有细节。

# 生成报表

生成报告有助于组织您的工作，并为您提供一个在渗透测试期间查看所有输出和结果的位置。报告很重要，因为它们提供了一个领域中的所有信息，而不必返回到另一个文档。

1.  Now that we have installed and run a scan, it's time to grab the reports from our scan. With your results displayed, click on **Vulnerabilities**:

    ![Generating reports](graphics/3183OS_06_25.jpg)

2.  Click on **Export**:

    ![Generating reports](graphics/3183OS_06_26.jpg)

3.  Drag and drop the panels on the left to the right-hand side. Click on **Export**. This will download the file format that you have chosen:

    ![Generating reports](graphics/3183OS_06_27.jpg)

4.  Open the file to see whether it is in a viewable and working format, as shown:

    ![Generating reports](graphics/3183OS_06_28.jpg)

恭喜您在 Nessus 中成功生成漏洞报告！

# 解决漏洞

程序中的漏洞没有操作系统漏洞危险，因为黑客很少攻击它们。即使如此，一些程序漏洞也可能构成重大威胁，例如，Internet Explorer 或 Microsoft Office 中的漏洞。这些漏洞通常在补丁可用时通过 Windows 更新解决。安全更新可从 Microsoft Update、Windows Update 和 Office Update 获得。您可以通过对`security update`进行关键字搜索轻松找到它们。例如，如果 Nessus 检测到您的 Windows 系统上存在 MS07-036 漏洞，您可以搜索该安全公告编号，然后下载所有适用的更新以修补您的系统。当涉及到程序漏洞时，您必须始终检查最新的软件更新，并在可用时下载它们。

# 总结

好了，这就差不多结束了这一章！我当然希望你喜欢这一章。我们讨论了如何开始规划评估、评估的关键组成部分以及评估的逐步过程。我们安装 Nessus，注册它，下载插件，然后运行 Nessus。我们还创建了一个新的策略和扫描，确定了漏洞，阅读了漏洞的详细信息，并随后提出了漏洞的解决方案。现在，我们将进入下一章，您将学习客户端攻击！