# 物联网开发

物联网这个术语是由麻省理工学院媒体中心的凯文·阿什顿精心设计的。它描述了包括摄像机、车辆和传感器在内的物理设备网络。物联网被指数级采用，它代表着不可否认的承诺和可能性。这种快速采用为新的商业机会打开了大门，但另一方面，从安全角度来看，也暴露了新的威胁和弱点。这一章将是你的救世主。因此，您需要了解物联网生态系统，了解如何抵御现实世界的物联网攻击。事实上，在本章中，在学习如何利用物联网环境（从最小的设备到连接的汽车）后，您将获得准备好保护物联网项目所需的技能。根据 F5 实验室的报告，物联网攻击在 2017 年上半年爆发了 280%。在本章中，我们将完成我们的旅程。这是另一个里程碑。在了解了攻击和保护宝贵企业资产的不同技术之后，是时候继续学习经验，并发现物联网项目测试的技能了。

# 物联网生态系统

到 2020 年，将有超过 500 亿台连接设备。大量的设备将带来大量的新威胁。作为渗透测试者，我们需要准备好抵御这场技术灾难。物联网生态系统基于许多因素，我们也在下图中展示了这些因素：

*   商机
*   公共当局
*   消费者
*   基础设施

![](../images/00361.jpeg)

# 物联网项目架构

与任何技术项目一样，典型的物联网项目由许多组件组成，如下所示（见下图）：

*   **远程设备**
*   **数据存储**
*   **物联网设备****（例如，闭路电视摄像机、家庭路由器、打印机、工业系统和连接的汽车）**
***   **网关****

 **此图显示了物联网项目的典型架构：

![](../images/00362.jpeg)

# 物联网协议

在一个典型的物联网项目中，涉及许多协议以确保满足要求。它们被分为不同的层。以下是一些众所周知的物联网协议：

*   **Wi-Fi**：这是物联网开发者广泛使用的协议。它基于 IEEE 802.11 标准。它使用 2.4 GHz 和 5 GHz 作为频带频率，范围约为 50 米。通常，它可以传输 150-200 Mbps 的数据。
*   **Z 波**：这是一种低功率容量的射频通信技术。它以 100 Kbps 的数据速率广泛应用于传感器和家庭自动化产品中。它最多可以控制 232 台设备，范围为 30 米。
*   **Zigbee**：这就像蓝牙。它基于 IEEE 802.15.4 协议，工作频率为 2.4 GHz。它通常用于我们没有大数据速率的情况，通常是 250kbps，范围为 100 米。有许多 Zigbee 配置文件，例如 Zigbee PRO 和 Zigbee 遥控器（RF4CE）。最新版本是 Zigbee 3，它结合了所有以前的 Zigbee 标准。
*   **Sigfox**：这是一项范围广泛的技术，在农村环境中为 30-50 公里，在城市环境中为 3-10 公里。它的工作频率为 900 MHz，数据速率为 10-1000 Kbps。你不需要许可证就可以使用它的波段，因为它是在免费使用波段（ISM）上运行的。
*   **劳拉**：这与西格福克斯相似。它设计用于广域网网络（城市环境为 2-5 公里，郊区环境为 15 公里），数据速率为 0.3-50 Kbps。
*   **近场通信（NFC）**：这是一种基于 ISO/IEC 18000-3 标准的双向交互技术，频率为 13.56MHz，广泛应用于智能手机，尤其是非接触式支付操作。它的工作范围为 4 到 10 厘米，数据速率为 100–420 Kbps。
*   **IPv6 低功耗无线个人区域网****6LOWPAN**：根据 RFC 6282 基于互联网协议。它的适应性非常强，同时可以使用不同的通信平台，如 Wi-Fi 和以太网。

# 物联网通信栈

物联网通信堆栈类似于 OSI 网络模型。它表示所需的特性以及不同层之间的交互。它由以下几层组成：

*   数据层
*   端到端层
*   网络层
*   ID 层
*   链路层
*   物理层

![](../images/00363.jpeg)

# IP 智能对象协议套件

与 TCP/IP 模型类似，物联网项目有自己的套件和表示形式，名为*IP 智能对象协议套件*：

![](../images/00364.jpeg)

# 标准组织

物联网显示了一个充满希望的未来。因此，它需要由许多组织和联盟进行组织和标准化。以下是一些知名的物联网标准组织：

*   **国际电工委员会（IEC）**：**作为物联网标准的最大贡献者之一，**IEC 发挥着巨大的作用，尤其是其 IEC 62056（DLMS/COSEM）讨论了智能电表。
*   **国际标准化组织（ISO）**：ISO 通过 ISO/AWI 18575 标准处理各种产品，特别是供应链中的物联网。ISO 还与 IEC 联合作为一个联合技术委员会。
*   **电气与电子工程师协会（IEEE）**：除了 IEEE 802.15.4 等其他标准外，IEEE 还为物联网制定了 IEEE P2413 标准。
*   **互联网工程任务组（IETF）**：IETF 对物联网具有以网络为中心的愿景。这一愿景得到了受限 RESTful 环境和 IPv6 协议的支持。

# 物联网攻击面

上一节是物联网生态系统的小概述。物联网为企业提供了一个惊人的增长机会，但同时也带来了大量的威胁。从不同的角度来看，物联网面临许多挑战，包括安全性、集成问题和互操作性。在市场开发的早期阶段，物联网可能会对这些表面发出许多安全警报和技术威胁。

# 装置及用具

设备是物联网项目的核心组件。在本小节中，我们将发现硬件威胁，并在另一点上讨论框架攻击。物理安全在信息安全中发挥着巨大的作用。物理上未受保护的设备对您的体系结构构成了真正的威胁。暴露的设备很容易受到攻击。因此，黑帽黑客可以在线收集有关该设备的信息，这要归功于公开可用的数据表以及大多数已使用和知名设备的必要信息。像[这样的网站 https://wiki.openwrt.org](https://wiki.openwrt.org) 帮助用户了解路由器、网关等多种设备的详细信息：

![](../images/00365.jpeg)

此步骤可能是危险的，因为通过了解硬件信息，攻击者可以识别（作为入口点）使用的接口，如**通用异步接收器/发射器**（**UART**），如果攻击者通过查找**引脚**成功连接到设备，则允许 root 访问（**TX**、**RX**、**GND**），使用万用表作为导通性模式（此模式无需电源）：

![](../images/00366.gif)

上图显示了与 USB 电缆连接的引脚。您需要找到波特率，它类似于比特率（每秒比特数），但它是每秒信号变化。换句话说，它是每秒以符号形式变化的信息数量。要识别设备的波特率，可以使用 Craig Heffner 从这个 GitHub 链接开发的脚本：[https://github.com/devttys0/baudrate/blob/master/baudrate.py](https://github.com/devttys0/baudrate/blob/master/baudrate.py) 。一旦获得合适的波特率，就可以连接到设备。

# 固件

**固件**是一套控制设备硬件的软件。分析固件是物联网渗透测试的关键步骤。为了实现这一点，您可以使用许多工具和实用程序。其中之一是**binwalk**，这是克雷格·赫夫纳（Craig Heffner）开发的一个伟大工具，帮助 pentesters 分析物联网设备的固件。您只需从这个 GitHub 链接[获取它即可 https://github.com/ReFirmLabs/binwalk/blob/master/INSTALL.md](https://github.com/ReFirmLabs/binwalk/blob/master/INSTALL.md) 。让我们运行以下命令：

```
# git clone https://github.com/ReFirmLabs/binwalk/
# cd binwalk
# ./deps.sh
```

然后，使用以下命令安装它：

```
# sudo ./setup.py install
```

![](../images/00367.jpeg)

如果您使用的是 Kali Linux 发行版，则可以通过在 CLI 中键入`binwalk`直接使用 binwalk：

![](../images/00368.jpeg)

例如，如果要使用 binwalk 收集有关 Airlink 101 AR430W V1 路由器二进制文件的信息，请使用以下命令：

```
# binwalk ar430w-firmware.bin
```

![](../images/00369.jpeg)

要从二进制文件中提取文件，请添加`-e`选项：

![](../images/00370.jpeg)

如果要提取特定的文件类型，请使用`-D`选项：

```
# binwalk -D 'png image:png' <firmware_binary_here>
```

从二进制文件中提取文件后，可以执行固件分析。如果您想使流程自动化，可以使用[中的**firmwalker**https://github.com/craigz28/firmwalker](https://github.com/craigz28/firmwalker) ：

![](../images/00371.jpeg)

# 网络接口

不安全的 web 界面给物联网项目带来了巨大的风险。许多设备都集成了 web 服务器，与任何其他 web 服务器应用程序项目一样，它们容易受到 web 应用程序攻击，并可被利用。集成的 web 应用程序不仅容易受到攻击，而且缺少传输加密也是一个危险的举动；因此，发送的消息可以被截获。

# 网络服务

网络服务在任何物联网项目中都是必不可少的。如前几节所述，典型的物联网项目可能使用多种通信协议，这些通信面临不同的威胁：它们代表着攻击者的高姿态目标。对于攻击者来说，映射攻击面可以使黑客尝试更加有效。

# 云接口和第三方 API

物联网项目可以使用云接口和第三方 API。它们在现代组织中发挥着重要作用，尤其是在物联网项目中，同时简化了许多云流程。这就是为什么作为一名渗透测试人员，您应该将其考虑在内。敏感数据可以通过这些通道传输，许多 API 用于身份验证和授权。因此，您需要确保云接口和第三方 API 的安全性。

# 案例研究-Mirai 僵尸网络

为了对不安全物联网的危险影响有一个更清楚的认识和良知，让我们深入研究一下袭击数百万设备和用户的灾难性攻击之一。它是**Mirai 僵尸网络**。Mirai 在日语中的意思是未来。它使用数百万台受损设备以约 665 GBs 的速度对许多企业和服务提供商执行分布式**拒绝服务**（**DoS**），包括 DNS、Twitter、PayPal、reddit、Brian Krebs 网站和许多其他知名网站：

![](../images/00372.jpeg)

# OWASP 物联网项目

在第一章中，我们看到**开放式 Web 应用程序安全项目**（**OWASP**指南）是著名的 Web 应用程序安全标准之一。他们也很活跃，他们制定了一份新的清单，列出了物联网项目面临的十大威胁。下面将提到这 10 种威胁。

# 不安全的 web 界面

如前所述，web 界面在任何物联网项目中都很重要。这就是为什么不安全的 web 界面被列为十大威胁的原因。为确保您的物联网网络接口通常是安全的，请至少使用 web 应用程序漏洞扫描器。**Nikto**是检查 web 应用程序安全性最常用的工具之一。如果您使用的是 Kali Linux，则可以通过 CLI 直接使用它。它是 Kali Linux 中的内置工具：

![](../images/00373.jpeg)

如果要使用 Nikto 扫描 web 应用程序界面，请键入以下命令：

```
#sudo nikto -h <your_interface_address_here>
```

在以下示例中，我们使用[www.example.com](http://www.example.com)网站作为演示：

![](../images/00374.jpeg)

# 身份验证/授权不足

身份验证问题是物联网设备真正的安全问题。如果接口没有使用强密码进行保护，设备可能会受到危害。正如您所看到的，尽管这些设备和装置都是新的，但攻击技术还是旧的。这一切都与用户的行为有关。为了避免这种类型的攻击，请确保所有密码都是强密码，并更改每个默认密码。例如，您可以使用[https://howsecureismypassword.net/](https://howsecureismypassword.net/) 要检查您的密码强度：

![](../images/00375.jpeg)

# 不安全网络服务

不安全的网络服务可能被利用，通过网络使用外部和内部手段危害设备，通常通过使用端口扫描仪识别打开的端口。在这种情况下，您需要确保只打开所需的端口。

# 缺少传输加密

以纯文本形式传递数据对您的物联网项目来说是一个巨大的风险。加密数据始终是避免数据被截获的最佳方法。有许多标准加密技术和协议，如 SSL 和 TLS。您可以使用名为`sslscan`的工具扫描项目，这是 Kali Linux 中的内置工具：

![](../images/00376.jpeg)

作为演示，这是扫描输出消息的一个片段：

![](../images/00377.jpeg)

# 隐私问题

许多隐私问题可能被确定为物联网项目的威胁。能够收集有关所用数据的信息，特别是敏感信息，可能是危险的；此外，获取有关设备功能的信息也是危险的。

# 不安全的云接口

云计算在现代物联网项目中扮演着重要角色。必须确保云接口的安全。作为安全措施，您至少需要缓解异常行为并实施帐户锁定机制。

# 不安全的移动接口

移动应用程序非常重要。不安全的移动接口可能会使物联网项目处于危险之中。攻击者可以截获未加密的数据。

# 安全配置不足

在配置方面，需要采取许多措施。分离管理面板和界面、记录安全事件和启用警报是避免安全配置不足的明智决策。

# 不安全的软件/固件

在前面的部分中，我们讨论了固件威胁，因为您知道它是一个软件，每个软件都可以被利用。使用静态和动态分析进行固件分析始终是强化固件的一个重要步骤。

# 人身安全差

别忘了人身安全。访问该设备可能会对您的项目构成威胁。暴露设备并将其放错地方可能是危险的。如果您将设备暴露给任何人，则可以通过开放接口（如 USB）对其进行拆解或访问。

# 窃听联网汽车

物联网设备和家用电器不是袭击的唯一受害者。最近，许多研究表明，连接的汽车也可能受到攻击。根据 2016 年 1 月的*车辆黑客漏洞调查*，60%的千禧一代支持车辆变得更加互联。现代互联汽车由以下许多单元组成：

*   信息娱乐（主机）-有时称为**发动机控制单元**（**ECU**）
*   远程信息处理和连接表单
*   全球定位系统和导航系统
*   车对车通信系统
*   安全和防盗系统
*   传感器
*   夜视

大多数连接的汽车都有一个控制器局域网，它将汽车的所有部件（传感器、安全气囊等）与中央控制单元连接起来。自 1993 年起，ISO 接受并发布了控制器局域网标准：

![](../images/00378.jpeg)

# 对联网汽车的威胁

互联汽车面临来自不同攻击载体的多种威胁。因为他们是由很多单位组成的,；有多种攻击类别：

*   固件攻击
*   操作系统攻击
*   对 CAN 的远程攻击
*   在 OBD2 上妥协
*   嗅
*   恶意下载的应用程序

作为一项安全研究，日产 Leaf 通过移动应用程序和网络浏览器遭到黑客攻击。2016 年 2 月，安全研究人员显示，可以使用日产的手机应用程序通过互联网访问日产。

# 总结

本章是一个简单明了的指南，帮助开发人员、制造商和渗透测试人员构建和保护物联网项目。我们首先发现物联网生态系统，以及典型物联网项目的不同组成部分。除了确保物联网环境安全所需的步骤外，我们还看到了物联网项目面临的威胁。此时，您获得了有效执行渗透测试任务的技术技能和适当心态。现在，您将能够保护现代组织基础架构免受当今的威胁和攻击，并部署针对这些攻击的适当防护措施。**